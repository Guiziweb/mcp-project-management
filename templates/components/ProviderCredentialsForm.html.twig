{% set form = this.formView %}

<div {{ attributes }}>
    {{ form_start(form, {action: path('oauth_google_callback'), method: 'POST'}) }}

    <div class="provider-selector">
        {% for child in form.provider %}
            <label class="provider-option{% if child.vars.value == selectedProvider %} selected{% endif %}">
                {{ form_widget(child, {
                    attr: {
                        'data-model': 'selectedProvider',
                        'data-action': 'change->live#update'
                    }
                }) }}
                <div class="icon">{% if child.vars.value == 'redmine' %}ðŸ”´{% else %}ðŸ”µ{% endif %}</div>
                <div class="name">{{ child.vars.label }}</div>
            </label>
        {% endfor %}
    </div>

    {# Render all credential fields dynamically #}
    {% for child in form %}
        {% if child.vars.name not in ['provider', 'submit', '_token'] %}
            <div class="form-group">
                {{ form_label(child) }}
                {{ form_widget(child) }}
                {% if child.vars.help %}
                    <div class="help-text">{{ child.vars.help }}</div>
                {% endif %}
                {{ form_errors(child) }}
            </div>
        {% endif %}
    {% endfor %}

    {{ form_widget(form.submit, {attr: {'data-live-ignore': true}}) }}

    {{ form_end(form) }}
</div>